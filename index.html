<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>無名牛排 — 菜單推播</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #FF6B6B; --gold: #f0c060; }
        html { scroll-behavior: smooth; }
        body {
            margin: 0; padding: 0; color: #fff;
            font-family: 'Noto Sans TC', 'Arial', sans-serif;
            overflow: hidden; height: 100vh;
        }
        .video-background {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; z-index: -1; overflow: hidden;
        }
        .video-background video {
            position: absolute; top: 50%; left: 50%;
            min-width: 100%; min-height: 100%; width: auto; height: auto;
            transform: translateX(-50%) translateY(-50%); object-fit: cover;
        }
        .video-overlay { position: absolute; inset: 0; background: rgba(10,10,42,0.72); }

        .loading-overlay {
            position: fixed; inset: 0; background: #000;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 10001; transition: opacity 0.5s ease-in-out;
        }
        .loading-overlay p { margin-top: 16px; font-size: 14px; color: rgba(255,255,255,0.5); letter-spacing: 2px; }
        .spinner {
            border: 8px solid rgba(255,255,255,0.15);
            border-top: 8px solid var(--gold);
            border-radius: 50%; width: 60px; height: 60px;
            animation: spin 1.2s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        .fullscreen-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.88);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 9999; text-align: center; backdrop-filter: blur(6px);
        }
        .fullscreen-overlay h2 { font-size: 1.6rem; color: var(--accent); margin-bottom: 10px; }
        .fullscreen-overlay p  { font-size: 0.95rem; color: rgba(255,255,255,0.6); margin-bottom: 22px; }
        .fullscreen-button {
            padding: 15px 44px; background: #ff6600; color: white;
            border: none; border-radius: 8px; font-size: 19px; cursor: pointer;
            font-family: 'Noto Sans TC', sans-serif; font-weight: 700;
            letter-spacing: 2px; transition: all 0.3s;
        }
        .fullscreen-button:hover { background: #ff8833; transform: scale(1.04); }

        .violation-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.82);
            display: none; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 10000; backdrop-filter: blur(5px);
        }
        .violation-content {
            background: #2a2a40; padding: 40px 30px; border-radius: 15px;
            max-width: 80%; border: 2px solid #ff6600; text-align: center;
            animation: modal-bounce 0.8s ease-in-out;
        }
        .violation-content h2 { font-size: 2rem; color: #ff6600; margin-bottom: 20px; }
        .violation-content p  { font-size: 1.1rem; line-height: 1.6; margin-bottom: 28px; }
        .violation-close-button {
            padding: 12px 24px; background: #ff6600; color: white;
            border: none; border-radius: 5px; font-size: 1rem; cursor: pointer;
            font-family: 'Noto Sans TC', sans-serif; transition: all 0.3s;
        }
        .violation-close-button:hover { background: #ff8833; }
        @keyframes modal-bounce {
            0%,20%,50%,80%,100%{transform:translateY(0)}
            40%{transform:translateY(-28px)} 60%{transform:translateY(-14px)}
        }

        /* ── 頂部快捷列 ── */
        #top-bar {
            position: fixed; top: 0; left: 0; right: 0; z-index: 500;
            display: flex; align-items: center;
            padding: 0 20px; height: 54px;
            background: linear-gradient(180deg, rgba(6,6,22,0.97) 0%, rgba(6,6,22,0.88) 100%);
            border-bottom: 1px solid rgba(240,192,96,0.12);
            backdrop-filter: blur(10px);
            gap: 6px;
        }
        .top-brand { display: flex; flex-direction: column; justify-content: center; margin-right: 14px; flex-shrink: 0; }
        .top-brand .name { font-size: 15px; font-weight: 900; letter-spacing: 3px; color: var(--gold); line-height: 1.1; }
        .top-brand .sub  { font-size: 9px; color: rgba(240,192,96,0.45); letter-spacing: 2px; }
        .top-sep { width: 1px; height: 28px; background: rgba(255,255,255,0.12); margin: 0 6px; flex-shrink: 0; }
        .cat-btn {
            padding: 5px 14px; border-radius: 18px;
            border: 1px solid rgba(255,255,255,0.16);
            background: transparent; color: rgba(255,255,255,0.6);
            font-size: 13px; font-weight: 700;
            font-family: 'Noto Sans TC', sans-serif;
            cursor: pointer; letter-spacing: 1px; transition: all 0.2s; white-space: nowrap;
        }
        .cat-btn:hover { background: rgba(240,192,96,0.14); color: var(--gold); border-color: rgba(240,192,96,0.35); }
        .cat-btn.active { background: rgba(240,192,96,0.18); color: var(--gold); border-color: var(--gold); }
        .top-spacer { flex: 1; }
        #auto-ctrl { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
        #auto-toggle {
            width: 36px; height: 20px; border-radius: 10px;
            border: none; cursor: pointer; position: relative;
            background: rgba(255,255,255,0.15); transition: background 0.3s;
        }
        #auto-toggle.on { background: #28a745; }
        #auto-toggle::after {
            content: ''; position: absolute; top: 2px; left: 2px;
            width: 16px; height: 16px; border-radius: 50%;
            background: #fff; transition: left 0.3s;
        }
        #auto-toggle.on::after { left: 18px; }
        #auto-label { font-size: 11px; color: rgba(255,255,255,0.45); letter-spacing: 1px; }
        #slide-counter { font-size: 11px; color: rgba(255,255,255,0.3); letter-spacing: 1px; margin-left: 6px; }

        /* ── 菜單卡片 ── */
        .content-wrapper {
            width: 100%; height: 100vh;
            display: flex; align-items: center; justify-content: center;
            position: relative; z-index: 10; padding-top: 54px;
        }
        #menu-card {
            width: min(1200px, 90vw);
            height: min(620px, calc(82vh - 54px));
            background: #fff; border-radius: 20px;
            overflow: hidden; display: flex;
            box-shadow: 0 28px 90px rgba(0,0,0,0.65);
            transition: opacity 0.3s ease;
        }
        #menu-card.fading { opacity: 0; }

        #img-panel { width: 50%; flex-shrink: 0; position: relative; overflow: hidden; background: #111; }
        #main-img { width: 100%; height: 100%; object-fit: cover; display: block; }
        #cat-badge {
            position: absolute; top: 16px; left: 16px;
            background: rgba(0,0,0,0.62); color: #fff;
            font-size: 13px; font-weight: 700;
            padding: 6px 15px; border-radius: 18px;
            letter-spacing: 2px; backdrop-filter: blur(4px);
        }
        #ring-wrap { position: absolute; bottom: 14px; right: 14px; width: 34px; height: 34px; }
        #ring-wrap svg { width: 34px; height: 34px; transform: rotate(-90deg); }

        #info-panel {
            flex: 1; padding: 36px 42px 28px;
            display: flex; flex-direction: column;
            background: #f5f6fa; overflow-y: auto;
        }
        #item-name { font-size: clamp(18px, 2.2vw, 34px); font-weight: 900; color: #1a2340; line-height: 1.25; margin-bottom: 8px; }
        #set-items {
            display: flex; flex-direction: row; flex-wrap: wrap; gap: 5px;
            margin-top: 8px;
        }
        .set-tag {
            display: inline-flex; align-items: center; gap: 5px;
            background: #1a2340;
            border-radius: 20px; padding: 4px 11px 4px 5px;
            font-size: 11.5px; font-weight: 700; color: #fff;
            letter-spacing: 0.5px;
        }
        .set-tag .set-num {
            background: var(--gold); color: #1a1a1a;
            border-radius: 50%; width: 17px; height: 17px;
            display: flex; align-items: center; justify-content: center;
            font-size: 10px; font-weight: 900; flex-shrink: 0;
        }
        #price-row { display: flex; align-items: baseline; gap: 14px; margin-bottom: 4px; }
        #item-price { font-size: clamp(26px, 3.1vw, 44px); font-weight: 900; color: #3355cc; }
        #item-weight { font-size: 13px; color: #3355cc; font-style: italic; font-weight: 500; }
        #divider { width: 100%; height: 1px; background: #dde0eb; margin: 15px 0; }
        #hover-desc { font-size: 14.5px; color: #2c3558; line-height: 1.9; white-space: pre-wrap; flex: 1; overflow-y: auto; }
        #item-counter { margin-top: 10px; font-size: 11px; color: #b0bace; letter-spacing: 1px; text-align: right; }

        /* ── 底部 ── */
        #dots {
            position: fixed; bottom: 76px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 5px; z-index: 200;
        }
        .dot { width: 6px; height: 6px; border-radius: 50%; background: rgba(255,255,255,0.2); cursor: pointer; transition: all 0.3s; }
        .dot.active { background: rgba(255,255,255,0.9); transform: scale(1.5); }

        #nav {
            position: fixed; bottom: 22px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 14px; z-index: 200;
        }
        .nav-btn {
            padding: 11px 34px; border-radius: 40px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.1); color: #fff;
            font-size: 15px; font-family: 'Noto Sans TC', sans-serif; font-weight: 700;
            cursor: pointer; letter-spacing: 1px; backdrop-filter: blur(8px);
            transition: background 0.2s, transform 0.15s;
        }
        .nav-btn:hover { background: rgba(255,255,255,0.22); transform: translateY(-2px); }
        .nav-btn:active { transform: scale(0.97); }

        .video-controls {
            position: fixed; bottom: 22px; right: 22px;
            z-index: 200; display: flex; gap: 8px;
        }
        .video-controls button {
            background: rgba(0,0,0,0.4); border: none; color: white;
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: background 0.3s;
        }
        .video-controls button:hover { background: rgba(0,0,0,0.72); }

        .protection-badge {
            position: fixed; bottom: 22px; left: 22px;
            background: rgba(0,0,0,0.38); color: white;
            padding: 7px 12px; border-radius: 18px; font-size: 12px;
            display: flex; align-items: center; gap: 7px;
            z-index: 200; opacity: 0.45;
        }
        #progress-bar {
            position: fixed; bottom: 0; left: 0; height: 3px;
            background: linear-gradient(90deg, #8B3A10, var(--gold));
            transition: width 0.4s ease; z-index: 300;
        }
    </style>
</head>
<body>

<div class="loading-overlay" id="loading-overlay">
    <div class="spinner"></div>
    <p>載入菜單中…</p>
</div>

<div class="fullscreen-overlay" id="fullscreen-overlay">
    <h2><i class="fas fa-expand"></i></h2>
    <p>請進入全螢幕模式以獲得最佳瀏覽體驗</p>
    <button class="fullscreen-button" id="fullscreen-button">
        <i class="fas fa-expand-arrows-alt"></i>&nbsp;&nbsp;進入全螢幕
    </button>
</div>

<div class="violation-modal" id="violation-modal">
    <div class="violation-content">
        <h2><i class="fas fa-exclamation-circle"></i></h2>
        <p></p>
        <button class="violation-close-button" id="violation-close-button">確定</button>
    </div>
</div>

<div class="video-background">
    <video id="bg-video" autoplay muted loop playsinline>
        <source src="https://assets.codepen.io/3364143/sample.mp4" type="video/mp4">
    </video>
    <div class="video-overlay"></div>
</div>

<div id="progress-bar"></div>

<div id="top-bar">
    <div class="top-brand">
        <div class="name">無名牛排</div>
        <div class="sub">原肉直火專家</div>
    </div>
    <div class="top-sep"></div>
    <div id="cat-btns" style="display:flex;gap:6px;"></div>
    <div class="top-spacer"></div>
    <div id="auto-ctrl">
        <span id="auto-label">自動播放</span>
        <button id="auto-toggle" class="on"></button>
        <span id="slide-counter"></span>
    </div>
</div>

<div class="content-wrapper">
    <div id="menu-card">
        <div id="img-panel">
            <img id="main-img" src="" alt="" loading="lazy">
            <div id="cat-badge"></div>
            <div id="ring-wrap">
                <svg viewBox="0 0 34 34">
                    <circle cx="17" cy="17" r="13" fill="none" stroke="rgba(255,255,255,0.18)" stroke-width="3"/>
                    <circle id="ring-fill" cx="17" cy="17" r="13" fill="none" stroke="#f0c060" stroke-width="3"
                        stroke-linecap="round" stroke-dasharray="82" stroke-dashoffset="82"/>
                </svg>
            </div>
        </div>
        <div id="info-panel">
            <div id="item-name"></div>
            <div id="price-row">
                <div id="item-price"></div>
                <div id="item-weight"></div>
            </div>
            <div id="set-items"></div>
            <div id="divider"></div>
            <div id="hover-desc"></div>
            <div id="item-counter"></div>
        </div>
    </div>
</div>

<div id="dots"></div>
<div id="nav">
    <button class="nav-btn" onclick="prev()">&#8249; 上一個</button>
    <button class="nav-btn" onclick="next()">下一個 &#8250;</button>
</div>

<div class="video-controls">
    <button id="mute-toggle"><i class="fas fa-volume-mute"></i></button>
    <button id="pause-play"><i class="fas fa-pause"></i></button>
</div>
<div class="protection-badge"><i class="fas fa-shield-alt"></i></div>

<script src="menu_items.js"></script>
<script src="menu_images.js"></script>
<script>
// catStarts 從 menu_items.js 裡的資料推算
const catStarts = {};
MENU_ITEMS.forEach((item, i) => {
    if (!catStarts.hasOwnProperty(item.cat)) catStarts[item.cat] = i;
});

let cur = 0;
const total = MENU_ITEMS.length;
const maxD = Math.min(total, 30);
const AUTO_INTERVAL = 6000;
let autoPlay = true;
let autoTimer = null;
let ringTimer = null;
let ringProgress = 0;
const ringFill = document.getElementById('ring-fill');
const RING_CIRC = 82;

// 進度點
const dotsEl = document.getElementById('dots');
for (let i = 0; i < maxD; i++) {
    const d = document.createElement('div');
    d.className = 'dot';
    d.onclick = () => goTo(Math.round(i*(total-1)/(maxD-1)), true);
    dotsEl.appendChild(d);
}

// 分類按鈕
const catBtnsEl = document.getElementById('cat-btns');
Object.keys(catStarts).forEach(cat => {
    const btn = document.createElement('button');
    btn.className = 'cat-btn';
    btn.textContent = cat;
    btn.dataset.cat = cat;
    btn.onclick = () => goTo(catStarts[cat], true);
    catBtnsEl.appendChild(btn);
});

function updateCatBtns() {
    const cc = MENU_ITEMS[cur].cat;
    document.querySelectorAll('.cat-btn').forEach(b => b.classList.toggle('active', b.dataset.cat === cc));
}

function render(animate) {
    const s = MENU_ITEMS[cur];
    const card = document.getElementById('menu-card');
    function update() {
        document.getElementById('main-img').src = MENU_IMAGES[cur];
        document.getElementById('cat-badge').textContent = s.cat;
        document.getElementById('item-name').textContent = s.name;
        document.getElementById('item-price').textContent = '$' + s.price;
        document.getElementById('item-weight').textContent = s.weight || '';
        document.getElementById('hover-desc').textContent = s.hoverDesc || '';
        document.getElementById('item-counter').textContent = (cur+1) + ' / ' + total;
        document.getElementById('slide-counter').textContent = (cur+1) + ' / ' + total;
        document.getElementById('progress-bar').style.width = ((cur+1)/total*100) + '%';
        document.querySelectorAll('.dot').forEach((d,i) => d.classList.toggle('active', Math.round(i*(total-1)/(maxD-1))===cur));
        updateCatBtns();

        // ── 附餐標籤
        const setEl = document.getElementById('set-items');
        setEl.innerHTML = '';
        const desc = s.desc || '';
        const tagRe = /[\u2460-\u2464][^\u2460-\u2464\n]*/g;
        const matches = desc.match(tagRe) || [];
        matches.forEach(m => {
            const num = m[0];
            const txt = m.slice(1).trim();
            const tag = document.createElement('div');
            tag.className = 'set-tag';
            tag.innerHTML = `<span class="set-num">${num}</span>${txt}`;
            setEl.appendChild(tag);
        });
    }
    if (animate) { card.classList.add('fading'); setTimeout(() => { update(); card.classList.remove('fading'); }, 280); }
    else update();
}

function goTo(idx, reset) { cur=(idx+total)%total; render(true); if(reset&&autoPlay) restartAuto(); }
function next() { goTo(cur+1, true); }
function prev() { goTo(cur-1, true); }

function startRing() {
    clearInterval(ringTimer); ringProgress=0; ringFill.style.strokeDashoffset=RING_CIRC;
    const dec = RING_CIRC/(AUTO_INTERVAL/100);
    ringTimer = setInterval(() => { ringProgress+=dec; ringFill.style.strokeDashoffset=Math.max(0,RING_CIRC-ringProgress); }, 100);
}
function stopRing() { clearInterval(ringTimer); ringFill.style.strokeDashoffset=RING_CIRC; }
function startAuto() { clearInterval(autoTimer); startRing(); autoTimer=setInterval(()=>{goTo(cur+1,false);startRing();},AUTO_INTERVAL); }
function stopAuto()  { clearInterval(autoTimer); stopRing(); }
function restartAuto() { stopAuto(); startAuto(); }

document.getElementById('auto-toggle').addEventListener('click', () => {
    autoPlay=!autoPlay;
    document.getElementById('auto-toggle').classList.toggle('on', autoPlay);
    autoPlay ? startAuto() : stopAuto();
});

const card = document.getElementById('menu-card');
card.addEventListener('mouseenter', ()=>{ if(autoPlay) stopAuto(); });
card.addEventListener('mouseleave', ()=>{ if(autoPlay) startAuto(); });

document.addEventListener('keydown', e => {
    if(e.key==='ArrowRight'||e.key==='ArrowDown') next();
    if(e.key==='ArrowLeft'||e.key==='ArrowUp')   prev();
    if(e.key===' ') { autoPlay=!autoPlay; document.getElementById('auto-toggle').classList.toggle('on',autoPlay); autoPlay?startAuto():stopAuto(); }
});

let tx=null;
document.addEventListener('touchstart', e=>{ tx=e.touches[0].clientX; });
document.addEventListener('touchend',   e=>{ if(tx===null)return; const dx=e.changedTouches[0].clientX-tx; if(Math.abs(dx)>50) dx<0?next():prev(); tx=null; });

// 全螢幕 & 防盜
const domEl = {
    loadingOverlay:    document.getElementById('loading-overlay'),
    fullscreenOverlay: document.getElementById('fullscreen-overlay'),
    fullscreenButton:  document.getElementById('fullscreen-button'),
    violationModal:    document.getElementById('violation-modal'),
    violationCloseBtn: document.getElementById('violation-close-button'),
    bgVideo:           document.getElementById('bg-video'),
    muteToggle:        document.getElementById('mute-toggle'),
    pausePlay:         document.getElementById('pause-play'),
};
function showV(msg){ domEl.violationModal.querySelector('p').textContent=msg; domEl.violationModal.style.display='flex'; }
function hideV(){ domEl.violationModal.style.display='none'; }

domEl.fullscreenButton.addEventListener('click', ()=>{
    document.documentElement.requestFullscreen().then(()=>{
        domEl.fullscreenOverlay.style.display='none';
        document.addEventListener('fullscreenchange', ()=>{ if(!document.fullscreenElement) showV('此網頁必須在全螢幕模式下瀏覽，請點擊確定以恢復。'); });
    }).catch(()=>{ domEl.fullscreenOverlay.style.display='none'; });
});
domEl.violationCloseBtn.addEventListener('click', ()=>{ document.documentElement.requestFullscreen().then(hideV).catch(hideV); });
domEl.muteToggle.addEventListener('click', ()=>{ domEl.bgVideo.muted=!domEl.bgVideo.muted; domEl.muteToggle.innerHTML=domEl.bgVideo.muted?'<i class="fas fa-volume-mute"></i>':'<i class="fas fa-volume-up"></i>'; });
domEl.pausePlay.addEventListener('click', ()=>{ if(domEl.bgVideo.paused){domEl.bgVideo.play();domEl.pausePlay.innerHTML='<i class="fas fa-pause"></i>';}else{domEl.bgVideo.pause();domEl.pausePlay.innerHTML='<i class="fas fa-play"></i>';} });

document.addEventListener('contextmenu', e=>{ e.preventDefault(); showV('此操作已被禁止：內容受版權保護。'); });
document.addEventListener('keydown', e=>{ if(e.keyCode===123||(e.ctrlKey&&e.shiftKey&&(e.keyCode===73||e.keyCode===74))||(e.ctrlKey&&e.keyCode===85)){ e.preventDefault(); showV('此網頁內容受保護，無法使用開發者工具。'); } });
document.body.onselectstart=()=>false;
document.body.oncopy=()=>false;
document.addEventListener('dragstart', e=>{ if(e.target.tagName==='IMG'){ e.preventDefault(); showV('圖像拖拽保存已被禁止。'); } });

window.addEventListener('load', ()=>{
    render(false);
    startAuto();
    domEl.loadingOverlay.style.opacity='0';
    domEl.loadingOverlay.addEventListener('transitionend', ()=>{ domEl.loadingOverlay.style.display='none'; }, {once:true});
});
</script>
</body>
</html>
